<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kernel Logistic Regression with Focal Mean Embeddings • klrfome</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Kernel Logistic Regression with Focal Mean Embeddings">
<meta property="og:description" content="Implementation of Kernel Logistic Regression on Focal Mean Embeddings for archaeological site location sensitivity modeling.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">klrfome</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette_intro_and_example_workflow.html">klrfome - Introduction and example workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrecos/klrfome">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<p align="center">
<img width="326" height="134" src="https://github.com/mrecos/klrfome/blob/master/klrfome_logo/KLR-black.png?raw=true"></p>
<div id="klrfome---kernel-logistic-regression-on-focal-mean-embeddings" class="section level4">
<h4 class="hasAnchor">
<a href="#klrfome---kernel-logistic-regression-on-focal-mean-embeddings" class="anchor"></a>klrfome - Kernel Logistic Regression on Focal Mean Embeddings</h4>
<p>The purpose of this package is to solve the <em>Distribution Regression</em> problem for archaeological site location modeling; or any other data for that matter. The aim of Distribution Regression is to map a single scalar outcome (e.g. presence/absence; 0/1) to a distribution of features. This is opposed to typical regression where you have one observation mapping a single outcome to a single set of features/predictors. For example, an archaeological site is singularly defined as either present or absent, however the area within the sites boundary is not singularly defined by any one measurement. The area with an archaeology site is defined by an infinite distribution of measurements. Modeling this in traditional terms means either collapsing that distribution to a single measurement or pretending that a site is actually a series of adjacent, but independent measurements. The methods developed for this package take a different view instead by modeling the distribution of measurements from within a single site on a scale of similarity to the distribution of measurements on other sites and the environmental background in general. This method avoids collapsing measurements and promotes the assumption of independence from within a site to between sites. By doing so, this approach models a richer description of the landscape in a more intuitive sense of similarity.</p>
<p>To achieve this goal, the package fits a Kernel Logistic Regression (KLR) model onto a mean embedding similarity matrix and predicts as a roving focal function of varying window size. The name of the package is derived from this approach; <strong>K</strong>ernel <strong>L</strong>ogistic <strong>R</strong>egression on <strong>FO</strong>cal <strong>M</strong>ean <strong>E</strong>mbeddings (<strong>klrfome</strong>) pronounced <em>clear foam</em>.</p>
<p align="center">
<img width="800" height="600" src="https://github.com/mrecos/klrfome/blob/master/SAA_2018_poster/SAA_2018_poster_small.jpg?raw=true"></p>
<p>(High-res versions of research poster are in the <a href="https://github.com/mrecos/klrfome/tree/master/SAA_2018_poster">/SAA_2018_poster</a> folder)</p>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h3>
<p>Please cite this package as:</p>
<blockquote>
<p>Harris, Matthew D., (2017). <em>klrfome - Kernel Logistic Regression on Focal Mean Embeddings</em>. Accessed 10 Sep 2017. Online at <a href="https://doi.org/10.5281/zenodo.1218403" class="uri">https://doi.org/10.5281/zenodo.1218403</a></p>
</blockquote>
</div>
<div id="special-thanks" class="section level3">
<h3 class="hasAnchor">
<a href="#special-thanks" class="anchor"></a>Special Thanks</h3>
<p>This model is inspired by and borrows from Zoltán Szabó’s work on mean embeddings <span class="citation">(Szabó et al. 2016, @Szabo2)</span> and Ji Zhu &amp; Trevor Hastie’s Kernel Logistic Regression algorithm <span class="citation">(Zhu and Hastie 2005)</span>. I extend a hardy <strong>thank you</strong> to Zoltán for his correspondence during the development of this approach. This approach would not have been created without his help. Further, a big <strong>thank you</strong> to Ben Markwick for his moral support and <code>rrtools</code> package used to create this package. However that being said, all errors, oversights, and omissions are my own.</p>
</div>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>You can install klrfome from github with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"mrecos/klrfome"</span>)</a></code></pre></div>
</div>
<div id="example-workflow-on-simulated-data-try-me" class="section level2">
<h2 class="hasAnchor">
<a href="#example-workflow-on-simulated-data-try-me" class="anchor"></a>Example workflow on simulated data (Try me!)</h2>
<p align="left">
<img src="https://github.com/mrecos/klrfome/blob/master/README_images/KLRfome_dataflow.png?raw=true"></p>
<p>In brief, the process below is 1) take a table of observations of two or more environmental variables within known sites and across the background of the study area; 2) use <code>format_data()</code> to convert that table to a list and under-sample the background data to a desired ratio (each group of observations with a site or background area are referred o in the ML literature as “bags”); 3) use <code>build_k()</code> function with the <code>sigma</code> hyperparameter and distance (default <code>euclidean</code>) to create a similarity matrix between all site and background bags; 4) the similarity matrix is the object that the kernel logistic regression model <code>klr()</code> function uses to fit its parameters. Steps 3 and 4 are where this method detracts most from traditional regression, but it is also what sets this method apart. unlike most regression that fits a model to a table of measurements, this approach fits a model to a matrix of similarities between all of the units of analysis (sites and background areas).</p>
<div id="libraries" class="section level4">
<h4 class="hasAnchor">
<a href="#libraries" class="anchor"></a>Libraries</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ggplot2"</span>)   <span class="co"># for plotting results</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"NLMR"</span>)      <span class="co"># for creating simulated landscapes</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"rasterVis"</span>) <span class="co"># for plotting simulated lan</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"pROC"</span>)      <span class="co"># for evaluation of model AUC metric</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"dplyr"</span>)     <span class="co"># for data manipulation</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"knitr"</span>)     <span class="co"># for printing tables in this document</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"klrfome"</span>)   <span class="co"># for modeling</span></a></code></pre></div>
</div>
<div id="set-hyperparameters-and-load-simulated-site-location-data" class="section level4">
<h4 class="hasAnchor">
<a href="#set-hyperparameters-and-load-simulated-site-location-data" class="anchor"></a>Set hyperparameters and load simulated site location data</h4>
<p>In this block, the random <code>seed</code>, <code>sigma</code> and <code>lambda</code> hyperparameters, and the <code>dist_metric</code> are all set. The <code>sigma</code> parameter controls how “close” observations must be to be considered similar. Closeness in this context is defined in the ‘feature space’, but in geographic or measurement space. At a higher <code>sigma</code> more distant observations can still be considered similar. The <code>lambda</code> hyperparameter controls the regularization in the KLR model by penalizing large coefficients; it must by greater than zero. This means that the higher the <code>lambda</code> penalty, the closer the model will shrink its <code>alpha</code> parameters closer to zero, thereby reducing the influence of any one or group of observations on the overall model. These two hyperparameters are most critical as the govern the flexibility and scope of the model. Ideally, these will be set via k-fold Cross-Validation, Leave-one-out cross-validation, grid search, or trial and error. Exploring these hyperparameters will likely take most of the time and attention within the modeling process.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">#Parameters</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">232</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">sigma =<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb3-4" title="4">lambda =<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb3-5" title="5">dist_metric =<span class="st"> "euclidean"</span></a></code></pre></div>
</div>
<div id="simulate-site-data-and-format" class="section level4">
<h4 class="hasAnchor">
<a href="#simulate-site-data-and-format" class="anchor"></a>Simulate site data and format</h4>
<p>Archaeological site data is protected information that can not often be shared. It is a major impediment to open archaeological research. In this package I created a function to simulate archaeological site data so that people can test the package and see how to format their site data. The <code>get_sim_data</code> function simulates <code>N_site_bags</code> number of sites from <code>site_sample</code> number of observations for two environmental variables. The variables are normal with a mean and standard deviation; well-discriminated defaults are provided. The function simulates by site-present and environmental background classes with different means and SD’s for the two variables. The returned object is a <code>list</code> that contains the data in a <code>list</code> format for use in the <code>KLR</code> functions, but also a <code>table</code> format for use in most other modeling functions. This is so that you can compare model results on the same data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">### Simulate Training Data</span></a>
<a class="sourceLine" id="cb4-2" title="2">sim_data &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_sim_data.html">get_sim_data</a></span>(<span class="dt">site_samples =</span> <span class="dv">800</span>, <span class="dt">N_site_bags =</span> <span class="dv">75</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">formatted_data &lt;-<span class="st"> </span><span class="kw"><a href="reference/format_site_data.html">format_site_data</a></span>(sim_data, <span class="dt">N_sites=</span><span class="dv">10</span>, <span class="dt">train_test_split=</span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">                                   <span class="dt">sample_fraction =</span> <span class="fl">0.9</span>, <span class="dt">background_site_balance=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">train_data &lt;-<span class="st"> </span>formatted_data[[<span class="st">"train_data"</span>]]</a>
<a class="sourceLine" id="cb4-6" title="6">train_presence &lt;-<span class="st"> </span>formatted_data[[<span class="st">"train_presence"</span>]]</a>
<a class="sourceLine" id="cb4-7" title="7">test_data &lt;-<span class="st"> </span>formatted_data[[<span class="st">"test_data"</span>]]</a>
<a class="sourceLine" id="cb4-8" title="8">test_presence &lt;-<span class="st"> </span>formatted_data[[<span class="st">"test_presence"</span>]]</a></code></pre></div>
</div>
<div id="build-similarilty-kernel-fit-klr-model-and-predict-on-training-set" class="section level4">
<h4 class="hasAnchor">
<a href="#build-similarilty-kernel-fit-klr-model-and-predict-on-training-set" class="anchor"></a>Build Similarilty kernel, fit KLR model, and predict on training set</h4>
<p>The first step in modeling these data is to build the similarity kernel with <code>build_k</code>. The output is a pairwise similarity matrix for each element of the list you give it, in this case <code>training_data</code>. The object <code>K</code> is the NxN similarity matrix of the mean similarity between the multivariate distance of each site and background list element. These elements are often referred to as <em>laballed bags</em> because they are a collection of measurements with a presence or absence label. The second step is to fit the <code>KLR</code> model with the <code>KLR</code> function. The <code>KLR</code> fit function is a key component of this package. The function fits a KLR model using Iterative Re-weighted Least Squares (IRLS). <code>Verbose = 2</code> shows the convergence of the algorithm. The output of this function is a <code>list</code> of the alpha parameters (for prediction) and predicted probability of site-present for the <code>train_data</code> set. Finally, the <code>KLR_predict</code> function uses the <code>train_data</code> and <code>alphas</code> to predict the probability of site-presence for new <code>test_data</code>. The similarity matrix can be visualized with <code>corrplot</code>, the predicted site-presence probability for simulated site-present and background test data can be viewed as a <code>ggplot</code>, and finally the parameters of the model are saved to a <code>list</code> to be used for predicting on a study area raster stack.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">##### Logistic Mean Embedding KRR Model</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#### Build Kernel Matrix</span></a>
<a class="sourceLine" id="cb5-3" title="3">K &lt;-<span class="st"> </span><span class="kw"><a href="reference/build_K.html">build_K</a></span>(train_data, <span class="dt">sigma =</span> sigma, <span class="dt">dist_metric =</span> dist_metric, <span class="dt">progress =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#### Train KLR model</span></a>
<a class="sourceLine" id="cb5-5" title="5">train_log_pred &lt;-<span class="st"> </span><span class="kw"><a href="reference/KLR.html">KLR</a></span>(K, train_presence, lambda, <span class="dv">100</span>, <span class="fl">0.001</span>, <span class="dt">verbose =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; Step 1. Absolute Relative Approximate Error = 120.2567</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; Step 2. Absolute Relative Approximate Error = 9.6064</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; Step 3. Absolute Relative Approximate Error = 0.6178</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; Step 4. Absolute Relative Approximate Error = 0.0477</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; Step 5. Absolute Relative Approximate Error = 0</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; Found solution in 5 steps.</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#### Predict KLR model on test data</span></a>
<a class="sourceLine" id="cb5-13" title="13">test_log_pred &lt;-<span class="st"> </span><span class="kw"><a href="reference/KLR_predict.html">KLR_predict</a></span>(test_data, train_data, <span class="dt">dist_metric =</span> dist_metric,</a>
<a class="sourceLine" id="cb5-14" title="14">                             train_log_pred[[<span class="st">"alphas"</span>]], sigma, <span class="dt">progress =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-15" title="15"></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">### Plot K Matrix</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="kw"><a href="reference/K_corrplot.html">K_corrplot</a></span>(K,train_data,<span class="dt">clusters=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="README_images/README-fit_model-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">### Plot Test Set Prediction</span></a>
<a class="sourceLine" id="cb6-3" title="3">predicted_log &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">pred =</span> test_log_pred, <span class="dt">obs =</span> test_presence)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(predicted_log, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(obs), <span class="dt">y =</span> pred, <span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(obs))) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span>(<span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> <span class="st">"Predicted Probability"</span>, <span class="dt">x =</span> <span class="st">"Site Presence"</span>,</a>
<a class="sourceLine" id="cb6-9" title="9">       <span class="dt">title =</span> <span class="st">"Kernel Logistic Regression"</span>,</a>
<a class="sourceLine" id="cb6-10" title="10">       <span class="dt">subtitle =</span> <span class="st">"test set predictions; simulated data"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(</a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="dt">legend.position =</span> <span class="st">"none"</span></a>
<a class="sourceLine" id="cb6-13" title="13">  )</a></code></pre></div>
<p><img src="README_images/README-fit_model-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">### Save parameters for later prediction</span></a>
<a class="sourceLine" id="cb7-3" title="3">params &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">train_data =</span> train_data,</a>
<a class="sourceLine" id="cb7-4" title="4">               <span class="dt">alphas_pred =</span> train_log_pred[[<span class="st">"alphas"</span>]],</a>
<a class="sourceLine" id="cb7-5" title="5">               <span class="dt">sigma =</span> sigma,</a>
<a class="sourceLine" id="cb7-6" title="6">               <span class="dt">lambda =</span> lambda,</a>
<a class="sourceLine" id="cb7-7" title="7">               <span class="dt">means =</span> formatted_data<span class="op">$</span>means,</a>
<a class="sourceLine" id="cb7-8" title="8">               <span class="dt">sds =</span> formatted_data<span class="op">$</span>sds)</a></code></pre></div>
</div>
<div id="predicting-on-a-raster-stack" class="section level4">
<h4 class="hasAnchor">
<a href="#predicting-on-a-raster-stack" class="anchor"></a>Predicting on a raster stack</h4>
<p align="left">
<img src="https://github.com/mrecos/klrfome/blob/master/README_images/KLRfome_prediction.png?raw=true"></p>
<p>This package can be used to predict on tabular data as above, but a more practical approach is to predict directly on a set of raster layers representing the predictor variables. Most of the code below is there for creating a simulated landscape that has some fidelity to the training data. For real-world examples, the prediction starts with a raster stack of predictor variable rasters. Form there the function <code>scale_prediction_rasters</code> center and scales the values of the rasters to that of the train_data. Having data that is centered at zero and scaled to z-scores is critical in measuring the distance between observations. Further, it is critical that the test data (raster stack) is scaled to the same values as the training data or the predictions will be invalid. Once scaled, the raster stack is sent to the <code>KLR_raster_predict</code> function for prediction. The prediction function requires a scaled raster stack of the same variables used to train the model, the <code>ngb</code> value that specifies the x and y dimension of the focal window, and finally the list of params from the trained model. The setting on <code>KLR_raster_predict</code> shown here are predicting over the entire raster at once and not in parallel. The <code>KLR_raster_predict</code> function has options for splitting the prediction into a number of squares and predicting on each of those. Further, each split raster block can be assigned to a different core on your computer to compute in parallel. This is because prediction is a time consuming process and it is often helpful to split the computation into more manageable blocks. Oh, and you can set it to return the predicted blocks as a list of raster (all in memory) or to save each block as a GeoTiff after it is predicted. A version of parallel processing is shown in the next code section.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">### width and hieght of roving focal window (required)</span></a>
<a class="sourceLine" id="cb8-2" title="2">ngb =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">### Number of rows and columns in prediction rasters</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">## needed for making simulated rasters, as well as for predicting real-world rasters</span></a>
<a class="sourceLine" id="cb8-5" title="5">cols =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb8-6" title="6">rows =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">### Create simulated environmental rasters  (sim data only) ####</span></a>
<a class="sourceLine" id="cb8-9" title="9">s_var1r &lt;-<span class="st"> </span>NLMR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/NLMR/topics/nlm_gaussianfield">nlm_gaussianfield</a></span>(cols,rows, <span class="dt">autocorr_range =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-10" title="10">s_var1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/rescale_sim_raster.html">rescale_sim_raster</a></span>(s_var1r, <span class="dv">50</span>, <span class="dv">10</span>) </a>
<a class="sourceLine" id="cb8-11" title="11">s_var2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/rescale_sim_raster.html">rescale_sim_raster</a></span>(s_var1r, <span class="dv">3</span>, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb8-12" title="12">b_var1r &lt;-<span class="st"> </span>NLMR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/NLMR/topics/nlm_gaussianfield">nlm_gaussianfield</a></span>(cols,rows,<span class="dt">autocorr_range =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-13" title="13">b_var1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/rescale_sim_raster.html">rescale_sim_raster</a></span>(b_var1r, <span class="dv">100</span>, <span class="dv">20</span>) </a>
<a class="sourceLine" id="cb8-14" title="14">b_var2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/rescale_sim_raster.html">rescale_sim_raster</a></span>(b_var1r, <span class="dv">6</span>, <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">### Create a site-present trend surface  (sim data only)</span></a>
<a class="sourceLine" id="cb8-16" title="16">trend_coords &lt;-<span class="st"> </span><span class="kw"><a href="reference/sim_trend.html">sim_trend</a></span>(cols, rows, <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-17" title="17">coords &lt;-<span class="st"> </span>trend_coords<span class="op">$</span>coords</a>
<a class="sourceLine" id="cb8-18" title="18">trend &lt;-<span class="st"> </span>trend_coords<span class="op">$</span>trend</a>
<a class="sourceLine" id="cb8-19" title="19">inv_trend &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="dv">1</span><span class="op">-</span>trend)</a>
<a class="sourceLine" id="cb8-20" title="20">var1 &lt;-<span class="st"> </span>(s_var1 <span class="op">*</span><span class="st"> </span>trend) <span class="op">+</span><span class="st"> </span>(b_var1 <span class="op">*</span><span class="st"> </span>inv_trend)</a>
<a class="sourceLine" id="cb8-21" title="21">var2 &lt;-<span class="st"> </span>(s_var2 <span class="op">*</span><span class="st"> </span>trend) <span class="op">+</span><span class="st"> </span>(b_var2 <span class="op">*</span><span class="st"> </span>inv_trend)</a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#### end simulated data creation ####</span></a>
<a class="sourceLine" id="cb8-23" title="23"></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">### Create raster stack of predictor variables</span></a>
<a class="sourceLine" id="cb8-25" title="25">pred_var_stack &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stack">stack</a></span>(var1, var2)</a>
<a class="sourceLine" id="cb8-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(pred_var_stack) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"var1"</span>,<span class="st">"var2"</span>)</a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">### scale rasters to training data</span></a>
<a class="sourceLine" id="cb8-28" title="28">pred_var_stack_scaled &lt;-<span class="st"> </span><span class="kw"><a href="reference/scale_prediction_rasters.html">scale_prediction_rasters</a></span>(pred_var_stack, params, <span class="dt">verbose =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">### Predict raster (single chunk, not in parallel) </span></a>
<a class="sourceLine" id="cb8-30" title="30">pred_rast &lt;-<span class="st"> </span><span class="kw"><a href="reference/KLR_raster_predict.html">KLR_raster_predict</a></span>(pred_var_stack_scaled, <span class="dt">ngb =</span> ngb, params, <span class="dt">split =</span> <span class="ot">FALSE</span>, <span class="dt">ppside =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb8-31" title="31">                                <span class="dt">progress =</span> <span class="ot">FALSE</span>, <span class="dt">parallel =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">### plot with simulated sites</span></a>
<a class="sourceLine" id="cb8-33" title="33">rasterVis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rasterVis/topics/levelplot-methods">levelplot</a></span>(pred_rast, <span class="dt">margin =</span> <span class="ot">FALSE</span>, <span class="dt">par.settings=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rasterVis/topics/rasterTheme">viridisTheme</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span>(<span class="kw">sp.points</span>(<span class="kw">sp.points</span>(<span class="kw">SpatialPoints</span>(coords), <span class="dt">pch=</span><span class="dv">15</span>, <span class="dt">cex =</span> <span class="fl">2.25</span>, <span class="dt">col =</span> <span class="st">"red"</span>)), <span class="dt">columns=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="README_images/README-predict_rasters-1.png" width="700"></p>
</div>
<div id="predicting-in-parallelmulti-core" class="section level3">
<h3 class="hasAnchor">
<a href="#predicting-in-parallelmulti-core" class="anchor"></a>Predicting in parallel/multi-core</h3>
<p>This package uses the <code>foreach</code> package’s <code>%dopar%</code> function to parallelize model prediction. To make this work you need to start a parallel backend. Here I show how to do this with <code>doParallel</code> package. It is simple in most cases, just make a cluster with <code>makeCluster</code> and the number of cores you have available and then register the cluster with <code>registerDoParallel</code> (note the use of <code>stopCluster()</code> when you are done). In the <code>KLR_raster_predict</code> function, you need to set a few things. Set <code>parallel</code> = <code>TRUE</code>, <code>split</code> = <code>TRUE</code>, and <code>ppside</code> is the number of raster blocks on the x and y axis (resulting in <code>ppside</code>^2 number of output rasters). The function also gives the options for <code>output = "list"</code> to return a <code>list</code> or <code>output = "save"</code> to save each raster as a GeoTiff to the <code>save_loc</code> directory. Finally, the <code>cols</code> and <code>rows</code> values are used here so that the split function knows the dimensions of the entire prediction raster. It need to know this becuase it mitigates the edge effect predicting on blocks by putting a collar of size <code>ngb</code> around each block. The <code>cols</code> and <code>rows</code> lets the function know when to remove the collar and when it is at an edge of the study area.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"doParallel"</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; Loading required package: foreach</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; Loading required package: iterators</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">### create and register parallel backend</span></a>
<a class="sourceLine" id="cb9-6" title="6">cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="kw">detectCores</span>())</a>
<a class="sourceLine" id="cb9-7" title="7">doParallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/doParallel/topics/registerDoParallel">registerDoParallel</a></span>(cl)</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">### Use same KLR_raster_predict function with parallel = TRUE</span></a>
<a class="sourceLine" id="cb9-10" title="10">pred_rast_list &lt;-<span class="st"> </span><span class="kw"><a href="reference/KLR_raster_predict.html">KLR_raster_predict</a></span>(pred_var_stack_scaled, <span class="dt">ngb =</span> ngb, params, <span class="dt">split =</span> <span class="ot">TRUE</span>, <span class="dt">ppside =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb9-11" title="11">                                   <span class="dt">progress =</span> <span class="ot">FALSE</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>, <span class="dt">output =</span> <span class="st">"list"</span>,</a>
<a class="sourceLine" id="cb9-12" title="12">                                   <span class="dt">save_loc =</span> <span class="ot">NULL</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">cols =</span> cols, <span class="dt">rows =</span> rows)</a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; Splitting rasters into blocks </span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; Predicting splits in parallel on 8 cores</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">### Merge list back to a single raster</span></a>
<a class="sourceLine" id="cb9-16" title="16">pred_rast &lt;-<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/do.call">do.call</a></span>(merge, pred_rast_list)</a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">### plot with simulated sites</span></a>
<a class="sourceLine" id="cb9-18" title="18">rasterVis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rasterVis/topics/levelplot-methods">levelplot</a></span>(pred_rast, <span class="dt">margin =</span> <span class="ot">FALSE</span>, <span class="dt">par.settings=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rasterVis/topics/rasterTheme">viridisTheme</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span>(<span class="kw">sp.points</span>(<span class="kw">sp.points</span>(<span class="kw">SpatialPoints</span>(coords), <span class="dt">pch=</span><span class="dv">15</span>, <span class="dt">cex =</span> <span class="fl">2.25</span>, <span class="dt">col =</span> <span class="st">"red"</span>)), <span class="dt">columns=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="README_images/README-multi-proc-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">### Or set output = "save" to save each prediction block out to a folder as a GeoTiff # not run</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co"># pred_rast_list &lt;- KLR_raster_predict(pred_var_stack_scaled, ngb = ngb, params, split = TRUE, ppside = 5,</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#                                    progress = FALSE, parallel = TRUE, output = "save",</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#                                    save_loc = "c:/Temp/tif", overwrite = TRUE)</span></a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">stopCluster</span>(cl)</a></code></pre></div>
<div id="model-evaluation" class="section level4">
<h4 class="hasAnchor">
<a href="#model-evaluation" class="anchor"></a>Model Evaluation</h4>
<p>Evaluating model on independent test data is very important for understanding the models ability to generalize to new observations. The <code>klrfome</code> package provides two functions to assist with this; <code>CM-quads()</code> and <code><a href="reference/metrics.html">metrics()</a></code>. In order to use these functions, the user needs to extract the sensitivity values output from <code>klr_raster_predict</code> at both site locations (preferably not those used to create the model) and a large number of random locations to sample the full distribution of sensitivities. The code below uses the simulated site locations, <code><a href="https://www.rdocumentation.org/packages/raster/topics/extract">raster::extract</a></code>, and <code>sampleRandom</code> to obtain these values. Once the values are put into a table and labelled as 1 or 0, the <code>CM-quads</code> function is applied to retrieve the True Positive, True Negative, False Positive, and False Negative values of the model at one or more probability thresholds. Choosing the appropriate threshold at which to classify a model into High, Moderate, and Low or Site-present vs. site-absent needs a good deal of consideration for both the intrinsic model quality and extrinsic model goals. Here I show how to evaluate the classification metrics at every <code>0.1</code> threshold between 0 and 1. The results from <code>CM_quads</code> (named for the four quadrants of the confusion matrix) are then evaluated with the <code><a href="https://www.rdocumentation.org/packages/pROC/topics/auc">pROC::auc</a></code> and <code><a href="reference/metrics.html">klrfome::metrics</a></code> functions to calculate the metrics of choice.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">### Make some polygons around the simulated site points.</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">### If all you have is points for sites, site radius can be an assumption</span></a>
<a class="sourceLine" id="cb11-3" title="3">site_pnts  &lt;-<span class="st"> </span><span class="kw">SpatialPoints</span>(coords)</a>
<a class="sourceLine" id="cb11-4" title="4">site_polys &lt;-<span class="st"> </span>rgeos<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rgeos/topics/misc-gBuffer">gBuffer</a></span>(site_pnts, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">byid =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">### extract sensitivity raster values to site areas</span></a>
<a class="sourceLine" id="cb11-7" title="7">site_sample &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/extract">extract</a></span>(pred_rast, site_polys, <span class="dt">weights =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb11-8" title="8">                               <span class="dt">small =</span> <span class="ot">TRUE</span>, <span class="dt">df =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">pred =</span> layer) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">presence =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">### sample for an environmental background of sensitivity values. (e.g. n = 500)</span></a>
<a class="sourceLine" id="cb11-12" title="12">bkg_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">ID =</span> <span class="dv">0</span>, <span class="dt">pred =</span> <span class="kw">sampleRandom</span>(pred_rast, <span class="dv">500</span>),</a>
<a class="sourceLine" id="cb11-13" title="13">                         <span class="dt">presence =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-14" title="14">model_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(site_sample, bkg_sample)</a>
<a class="sourceLine" id="cb11-15" title="15"></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">### A vector of the sensitivity thresholds that you want to evaluate the model at</span></a>
<a class="sourceLine" id="cb11-17" title="17">threshold &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">### Compute True Positive, True Negative, False Positive, and False Negative values at each threshold</span></a>
<a class="sourceLine" id="cb11-19" title="19">kstats &lt;-<span class="st"> </span><span class="kw"><a href="reference/CM_quads.html">CM_quads</a></span>(model_pred, threshold)</a>
<a class="sourceLine" id="cb11-20" title="20"></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">### use the pROC::auc and klrfome::metrics functions to compute the metrics of choice at each threshold</span></a>
<a class="sourceLine" id="cb11-22" title="22">Test_area_metrics &lt;-<span class="st"> </span>kstats <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Threshold) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">AUC =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(pROC<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/pROC/topics/auc">auc</a></span>(model_pred<span class="op">$</span>presence, model_pred<span class="op">$</span>pred, <span class="dt">type =</span> <span class="st">"linear"</span>),<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb11-25" title="25">                <span class="dt">YoudensJ =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="reference/metrics.html">metrics</a></span>(TP,TN,FP,FN)<span class="op">$</span>Informedness,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb11-26" title="26">                <span class="dt">KG       =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="reference/metrics.html">metrics</a></span>(TP,TN,FP,FN)<span class="op">$</span>KG,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb11-27" title="27">                <span class="dt">Sensitivity =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="reference/metrics.html">metrics</a></span>(TP,TN,FP,FN)<span class="op">$</span>Sensitivity,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb11-28" title="28">                <span class="dt">FPR =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="reference/metrics.html">metrics</a></span>(TP,TN,FP,FN)<span class="op">$</span>FPR,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb11-29" title="29">                <span class="dt">FNR =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="reference/metrics.html">metrics</a></span>(TP,TN,FP,FN)<span class="op">$</span>FNR,<span class="dv">3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb11-31" title="31"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-38" title="38"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-40" title="40"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-41" title="41"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-42" title="42"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-43" title="43"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-44" title="44"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-45" title="45"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-46" title="46"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-47" title="47"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-48" title="48"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-49" title="49"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-50" title="50"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-51" title="51"><span class="co">#&gt; Setting levels: control = 0, case = 1</span></a>
<a class="sourceLine" id="cb11-52" title="52"><span class="co">#&gt; Setting direction: controls &lt; cases</span></a>
<a class="sourceLine" id="cb11-53" title="53"></a>
<a class="sourceLine" id="cb11-54" title="54">knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(Test_area_metrics)</a></code></pre></div>
<table class="table table">
<thead><tr class="header">
<th align="right">Threshold</th>
<th align="right">TP</th>
<th align="right">FP</th>
<th align="right">TN</th>
<th align="right">FN</th>
<th align="right">AUC</th>
<th align="right">YoudensJ</th>
<th align="right">KG</th>
<th align="right">Sensitivity</th>
<th align="right">FPR</th>
<th align="right">FNR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">336</td>
<td align="right">500</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.85</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="right">0.1</td>
<td align="right">336</td>
<td align="right">357</td>
<td align="right">143</td>
<td align="right">0</td>
<td align="right">0.85</td>
<td align="right">0.286</td>
<td align="right">0.286</td>
<td align="right">1.000</td>
<td align="right">0.714</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">334</td>
<td align="right">281</td>
<td align="right">219</td>
<td align="right">2</td>
<td align="right">0.85</td>
<td align="right">0.432</td>
<td align="right">0.435</td>
<td align="right">0.994</td>
<td align="right">0.562</td>
<td align="right">0.006</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">322</td>
<td align="right">237</td>
<td align="right">263</td>
<td align="right">14</td>
<td align="right">0.85</td>
<td align="right">0.484</td>
<td align="right">0.505</td>
<td align="right">0.958</td>
<td align="right">0.474</td>
<td align="right">0.042</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">318</td>
<td align="right">203</td>
<td align="right">297</td>
<td align="right">18</td>
<td align="right">0.85</td>
<td align="right">0.540</td>
<td align="right">0.571</td>
<td align="right">0.946</td>
<td align="right">0.406</td>
<td align="right">0.054</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">311</td>
<td align="right">179</td>
<td align="right">321</td>
<td align="right">25</td>
<td align="right">0.85</td>
<td align="right">0.568</td>
<td align="right">0.613</td>
<td align="right">0.926</td>
<td align="right">0.358</td>
<td align="right">0.074</td>
</tr>
<tr class="odd">
<td align="right">0.6</td>
<td align="right">296</td>
<td align="right">150</td>
<td align="right">350</td>
<td align="right">40</td>
<td align="right">0.85</td>
<td align="right">0.581</td>
<td align="right">0.659</td>
<td align="right">0.881</td>
<td align="right">0.300</td>
<td align="right">0.119</td>
</tr>
<tr class="even">
<td align="right">0.7</td>
<td align="right">277</td>
<td align="right">126</td>
<td align="right">374</td>
<td align="right">59</td>
<td align="right">0.85</td>
<td align="right">0.572</td>
<td align="right">0.694</td>
<td align="right">0.824</td>
<td align="right">0.252</td>
<td align="right">0.176</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">238</td>
<td align="right">96</td>
<td align="right">404</td>
<td align="right">98</td>
<td align="right">0.85</td>
<td align="right">0.516</td>
<td align="right">0.729</td>
<td align="right">0.708</td>
<td align="right">0.192</td>
<td align="right">0.292</td>
</tr>
<tr class="even">
<td align="right">0.9</td>
<td align="right">112</td>
<td align="right">42</td>
<td align="right">458</td>
<td align="right">224</td>
<td align="right">0.85</td>
<td align="right">0.249</td>
<td align="right">0.748</td>
<td align="right">0.333</td>
<td align="right">0.084</td>
<td align="right">0.667</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">500</td>
<td align="right">336</td>
<td align="right">0.85</td>
<td align="right">0.000</td>
<td align="right">NaN</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>In this case those metrics are the <code>auc</code>, <code>Youdens J</code>, <code>KG</code> = Kvamme Gain, <code>Sensitivity</code>, <code>FPR</code> = False Positive Rate, and <code>FNR</code> = False Negative Rate. While there is no one metric that is a perfect descriptor of model performance in all scenarios, these are the metrics that I find most useful for describing archaeological predictive models. In this example, I am aiming to maximize my two-class classification for the Youden’s J (aka Informedness). As such, I would set my site-present vs. site-absent <code>Threshold</code> at <strong>0.6</strong>. At this threshold we have a <code>Sensitivity</code> = <strong>0.881</strong> and a <code>FPR</code> = <strong>0.3</strong>.</p>
</div>
</div>
</div>
<div id="main-package-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#main-package-functions" class="anchor"></a>Main Package Functions</h2>
<p>This package contains the functions necessary to compute Kernel Linear Regression (KLR) on mean kernel embeddings, functions for preparing site and background data, and a function for simulate archaeological site location data.</p>
<div id="klr_funs-r-for-fitting-and-predicting-on-tabular-data" class="section level4">
<h4 class="hasAnchor">
<a href="#klr_funs-r-for-fitting-and-predicting-on-tabular-data" class="anchor"></a>KLR_funs.R for Fitting and Predicting on Tabular Data</h4>
<ul>
<li><p><code>build_K</code> - Function takes list of training data, scalar value for <code>sigma</code> hyperparameter, and a distance method to compute a mean embedding similarity kernel. This kernel is a pair-wise (N x N) matrix of the mean similarity between the attributes describing each site location and background group. Optional inouts are <code>progress</code> for a progress bar and <code>dist_metric</code> for the distance computation. By default, the distance metric is <code>euclidean</code> and should likely stay as such unless you have explored other distances and know why/how you want to use them.</p></li>
<li><p><code>KLR</code> - Function takes the similarity kernel matrix <code>K</code>, a vector of presence/absence coded as <code>1</code> or <code>0</code>, and a scalar value for the <code>lambda</code> regularizing hyperparameter; optionally values for maximum iterations and threshold. This function performs Kernel Logistic Regression (KLR) via Iterative Re-weighted Least Squares (IRLS). The objective is to approximate a set of parameters that minimize the negative likelihood of the parameters given the data and response. This function returns a list of <code>pred</code>, the estimated response (probability of site-presence) for the training data, and <code>alphas</code>, the approximated parameters from the IRLS algorithm.</p></li>
<li><p><code>KLR_predict</code> - Function takes a list of the training data, a list of the testing data, a vector of the approximated <code>alphas</code> parameters, a scalar value for the <code>sigma</code> kernel hyperparameter, and a distance method. This function predicts the probability of site presence for new observations based on the training data and <code>alphas</code> parameters. This is accomplished by building the <code>k*k</code> kernel matrix as the similarity between the training test data then computing the inverse logit of <code>k*k %*% alphas</code>. The output is the predicted probability of site presence for each training data example.</p></li>
</ul>
</div>
<div id="raster_predict_funs-r-for-predicting-on-raster-data" class="section level4">
<h4 class="hasAnchor">
<a href="#raster_predict_funs-r-for-predicting-on-raster-data" class="anchor"></a>raster_predict_funs.R for Predicting on Raster Data</h4>
<ul>
<li><p><code>rescale_sim_raster</code> - Function that rescales simulated rasters from <code><a href="https://www.rdocumentation.org/packages/NLMR/topics/nlm_gaussianfield">NLMR::nlm_gaussianfield</a></code> <span class="citation">(Sciaini, Fritsch, and Simpkins 2017)</span> or whatever you want to use, to the mean and standard deviation of the simulated data used to fit the <code>klr</code> model. You will have to add the <code>mean</code> and <code>sd</code> arguments manually based on what you put into the <code>get_sim_data</code> function. The example in the code above inputs the default <code>mean</code> and <code>sd</code> values from the defualts of the <code>get_sim_data</code> function. Returned is a raster scaled too your simualted training data.</p></li>
<li><p><code>sim_trend</code> - Function is used to take create <code>n</code> number of simulated site locations of <code>size</code> cell dimensions on a <code>rows</code> by <code>cols</code> raster. The latter two arguments should match the size of your simulated rasters. The function randomly locates the sites and then creates a distance gradient (trend) from the site locations outward. The trend is a value <code>1</code> at the sites and reduces to <code>0</code> at the maximum combined distance from all sites. The output of this function is a <code>list</code> of a <code>matrix</code> of simulated site x/y coordinates (centers) and a <code>raster</code> of the trend surface. The point of the trend is to then combine it with the simulated rasters (as down in the code above) such that the raster depicting site-likely conditions is multiplied by the trend to output a raster retaining site-likely conditions near simulated site locations. Conversely, the site-unlikely simulated raster is multiplied by the inverse of the trend to result in a raster retaining site-unlikely characteristics away from the site locations. When those two rasters are added you get a simulated environment that is more preferable to site locations near site locations. It is a bit involved for something that had nothing to do with the actual KLRfome model, but it is needed to produce actual correlated environments for model testing.</p></li>
<li><p><code>scale_prediction_rasters</code> - Function scales your predictor <code>rater stack</code> based on the <code>params</code> list created in the model fitting process. This script simply loops over the rasters in the stack and centers and scales based on mean and sd of the training data used to fit the <code>klr</code> model. The function outputs a <code>raster stack</code>.</p></li>
<li><p><code>KLR_raster_predict</code> - Function predicts the probability of site-presence based on a <code>raster stack</code> of center/scaled predictor rasters, a focal neighborhood size in cells as <code>ngb</code>, and the <code>params</code> list of model fit parameters. Finally, the function also needs to the the number of columns as <code>cols</code> and rows as <code>rows</code> of the study areas raster stack. The rest of the arguments default to predicting the entire raster stack in one pass and only on a single core (not in parallel). The rest of the argument control whether the study area is split (<code>split = TRUE</code>) into a grid of blocks. The <code>ppside</code> positive integer controls the number of blocks along each axis of the study area. If you wish to compute the prediction in parallel, you will need to split it into blocks so that each block can be sent to a different processor core. The final set of optional arguments control how the prediction is returned, either as a <code>output = "list"</code> or <code>output = "save"</code> for returning a list of rasters of saving each out as a GeoTiff, and then arguments for the GeoTiff location with <code>save_loc</code> and whether to overwrite existing GeoTiffs with <code>overwrite</code>. The function contains a bit of logic to try and assist the user in which arguments go with what. Perhaps future versions will streamline this a bit.</p></li>
</ul>
</div>
<div id="format_site_data-r-for-data-formatting" class="section level4">
<h4 class="hasAnchor">
<a href="#format_site_data-r-for-data-formatting" class="anchor"></a>format_site_data.R for Data Formatting</h4>
<ul>
<li>
<code>format_site_data</code> - Function takes a <code>data.frame</code> of presence/background observations. The column <code>presence</code> indicated site presence of background as <code>1</code> or <code>0</code> respectively. The <code>SITENO</code> column indicates either a site identifier or <code>background</code>. The remaining columns should be measurements of environmental or cultural variables for modeling similarity. It is expected that each site will have multiple rows indicating multiple measurements of environmental variables from within the site boundary or land form. The function centers and scales the predictor variables, sub-samples the data into training and test sets, and re-formats the data as both tabular format and list format for both training and test data sets. Importantly, the function makes sure that no single site is in both the training and test set. No test sites are used to train the model. Also returned is the mean and standard deviation of the data so that new data can be center and scaled to the same parameters.</li>
</ul>
</div>
<div id="get_sim_data-r-for-simulating-site-location-data" class="section level4">
<h4 class="hasAnchor">
<a href="#get_sim_data-r-for-simulating-site-location-data" class="anchor"></a>get_sim_data.R for Simulating Site Location Data</h4>
<ul>
<li>
<code>get_sim_data</code> - Function takes a mean and SD for two simulated predictor variables for each of sites and background. With archaeological site data being a protected data set in many settings (including this project), it cannot be freely shared. However, it is difficult to implement this model without properly format data. This function simulates archaeological site data and background environmental data for testing or tuning of this model. The concept of the function is to simulate two predictor variables for both sites and background. The inputs to the function (defaults provided) control how similar or different the site data is from the background. The model can be tested on simulated site data that is very similar to the background or very different; the model behaves accordingly. The output of the function is formatted in the same way as the <code>format_site_data</code> function.</li>
</ul>
</div>
<div id="metrics-r-for-calculating-performance-metrics" class="section level4">
<h4 class="hasAnchor">
<a href="#metrics-r-for-calculating-performance-metrics" class="anchor"></a>metrics.R for Calculating Performance Metrics</h4>
<ul>
<li><p><code>CM_quads</code> - Function takes a data.frame of predicted probabilities (must be called <code>pred</code>) and actual observed presence/absence (must be called <code>presence</code> and contain <code>1 = presence</code> and <code>0 = absence</code>). Optional input is a threshold value or values in the form of a single scalar (default = 0.5) or a numeric vector to loop over. The function calculates the True Positive, True Negative, False Positive, and False Negative quantities at each threshold. These quantities are typically shown in a 2x2 confusion matrix, hence the name Confusion Matrix (CM) quadrants. The output is a data.frame with columns for the <code>TP</code>, <code>FP</code>, <code>TN</code>, and <code>FN</code> at each desired <code>Threshold</code>. This is useful for figuring out how the model performs at a variety of thresholds. In the example code above I also compute the <code>AUC</code> statistic that gives an indication of model performance across all thresholds.</p></li>
<li><p><code>metrics</code> - Function provides a large quantity of metrics based on the quadrants of the Confusion Matrix derived from a threshold of the predicted probability values. The input to this function is the <code>TP</code>, <code>TN</code>, <code>FP</code>, and <code>FN</code> quantities of a thresholded model as derived from the <code>CM_quads</code> function. The output of this model is a list of <code>51</code> different metrics such as <code>Sensitivity</code>, <code>Youden's J</code>, <code>Positive Predictive Gain</code>, and many more. Some are commonplace and others are practically unknown. I put a few note in the function as to where they come from. The function returns all <code>51</code> as a list.</p></li>
</ul>
</div>
<div id="plot-r-for-plotting-similarity-kernel" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-r-for-plotting-similarity-kernel" class="anchor"></a>plot.R for Plotting Similarity Kernel</h4>
<ul>
<li>
<code>K_corrplot</code> - Function is a pretty simple wrapper around <code><a href="https://www.rdocumentation.org/packages/corrplot/topics/corrplot">corrplot::corrplot()</a></code> with hierarchical clustering. Inputs for this function are the similarity matrix <code>K</code> and the <code>train_data</code> with the option of an integer for the number of clusters to partition the data; default = 4. Output is a plot or if assigned to an object, it is an object of class <code>matrix</code>.</li>
</ul>
</div>
</div>
<div id="licenses" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#licenses" class="anchor"></a>Licenses</h1></div>
<p><strong>Text and figures:</strong> <a href="http://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a></p>
<p><strong>Code:</strong> See the <a href="DESCRIPTION">DESCRIPTION</a> file</p>
<p><span class="math inline">\(\textbf{Data:}\)</span> <a href="http://creativecommons.org/publicdomain/zero/1.0/">CC-0</a> attribution requested in reuse</p>
</div>
<div id="contributions" class="section level1">
<h1 class="hasAnchor">
<a href="#contributions" class="anchor"></a>Contributions</h1>
<p>We welcome contributions from everyone. Before you get started, please see our <a href="CONTRIBUTING.html">contributor guidelines</a>. Please note that this project is released with a <a href="CONDUCT.html">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Flaxman">
<p>Flaxman, Seth, Yu-Xiang Wang, and Alexander J. Smola. 2015. “Who Supported Obama in 2012?: Ecological Inference Through Distribution Regression.” In <em>Proceedings of the 21th Acm Sigkdd International Conference on Knowledge Discovery and Data Mining</em>, 289–98. ACM.</p>
</div>
<div id="ref-2017arXiv170504293L">
<p>Law, H. C. L., D. J. Sutherland, D. Sejdinovic, and S. Flaxman. 2017. “Bayesian Approaches to Distribution Regression.” <em>ArXiv E-Prints</em>, May. <a href="http://arxiv.org/abs/1705.04293">http://arxiv.org/abs/1705.04293</a>.</p>
</div>
<div id="ref-Muandet">
<p>Muandet, Krikamol, Kenji Fukumizu, Bharath Sriperumbudur, and Bernhard Schölkopf. 2017. “Kernel Mean Embedding of Distributions: A Review and Beyond.” <em>Foundations and Trends in Machine Learning</em> 10 (1-2): 1–141. <a href="https://doi.org/10.1561/2200000060">https://doi.org/10.1561/2200000060</a>.</p>
</div>
<div id="ref-NLMR">
<p>Sciaini, Marco, Matthias Fritsch, and Craig E. Simpkins. 2017. <em>NLMR: Simulating Neutral Landscape Models</em> (version 0.2.0). <a href="https://CRAN.R-project.org/package=NLMR">https://CRAN.R-project.org/package=NLMR</a>.</p>
</div>
<div id="ref-Song">
<p>Song, Li, and Arthur Fukumizu Kenjiand Gretto. 2013. “Kernel Embeddings of Conditional Distributions: A Unified Kernel Framework for Nonparametric Inference in Graphical Models.” <em>IEEE Signal Processing Magazine</em> 30 (4): 98–111. <a href="https://doi.org/10.1109/msp.2013.2252713">https://doi.org/10.1109/msp.2013.2252713</a>.</p>
</div>
<div id="ref-Szabo2">
<p>Szabó, Zoltán, Arthur Gretton, Barnabás Póczos, and Bharath Sriperumbudur. 2015. “Two-Stage Sampled Learning Theory on Distributions.” In <em>International Conference on Artificial Intelligence and Statistics (Aistats)</em>, 948–57.</p>
</div>
<div id="ref-Szabo">
<p>Szabó, Zoltán, Bharath Sriperumbudur, Barnabás Póczos, and Arthur Gretton. 2016. “Learning Theory for Distribution Regression.” <em>Journal of Machine Learning Research</em> 17: 1–40.</p>
</div>
<div id="ref-Zhu">
<p>Zhu, Ji, and Trevor Hastie. 2005. “Kernel Logistic Regression and the Import-Vector Machine.” <em>Journal of Computational and Graphical Statistics</em> 14 (1): 185–205. <a href="https://doi.org/10.1198/106186005x25619">https://doi.org/10.1198/106186005x25619</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mrecos/klrfome">https://​github.com/​mrecos/​klrfome</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mrecos/klrfome/issues">https://​github.com/​mrecos/​klrfome/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Matthew Harris <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/103055953"><img src="https://zenodo.org/badge/103055953.svg" alt="DOI"></a></li>
<li><a href="https://travis-ci.org/mrecos/klrfome"><img src="https://travis-ci.org/mrecos/klrfome.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matthew Harris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
