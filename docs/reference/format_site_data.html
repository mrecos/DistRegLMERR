<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>format_site_data — format_site_data • klrfome</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="format_site_data — format_site_data" />

<meta property="og:description" content="`format_site_data()` formats a data.frame of a specific format into a list suitable for use with the klrfome model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">klrfome</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_intro_and_example_workflow.html">klrfome - Introduction and example workflow</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrecos/klrfome">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>format_site_data</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrecos/klrfome/blob/master/R/format_site_data.R'><code>R/format_site_data.R</code></a></small>
    <div class="hidden name"><code>format_site_data.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>`format_site_data()` formats a data.frame of a specific format into a list suitable for use with the klrfome model.</p>
    
    </div>

    <pre class="usage"><span class='fu'>format_site_data</span>(<span class='no'>dat</span>, <span class='no'>N_sites</span>, <span class='no'>train_test_split</span>, <span class='no'>background_site_balance</span>,
  <span class='no'>sample_fraction</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>- [data.frame] A data.frame of presence and absence records. Column "presence" must contain presence/absence as 1/0, and column "SITENO" contains the grouping variable.</p></td>
    </tr>
    <tr>
      <th>N_sites</th>
      <td><p>- [scalar] The number of sites to randomly select for analysis</p></td>
    </tr>
    <tr>
      <th>train_test_split</th>
      <td><p>- [scalar] a float from 0 to 1 indicating the percent of N_sites to be used as training dataset vs testing dataset.</p></td>
    </tr>
    <tr>
      <th>background_site_balance</th>
      <td><p>- [scalar] Integer &gt; 0 indicating how many background groups per site group</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>- list of various ways to arrange site data and mean/sd of data</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes a data.frame that at a mimimum must include a column for site presence/absence, a column for the site identifier, and one or more columns of covariates to be used in the regression model. There are three additional required parameters to this function and they are; `N_sites` which can be used to limit the number of sites (groups of the presence == 1 class) returned in the results; `train_test_split` that is used to split the site present data into training and testing data sets; and `background_site_balance` that is the ratio of background observation groups to include for each site group. The choice of `N_sites` and `background_site_balance` argument values are influenced by a number of factors including the amount of data, length of computation, and site prevelance.</p>
<p>This function returns a list object which is a reformatting of the input data where each list element if a grouping of present or absence observations. This is needed because the klrfome model works on groups of observations.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>sim_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_sim_data.html'>get_sim_data</a></span>(<span class='kw'>site_samples</span> <span class='kw'>=</span> <span class='fl'>800</span>, <span class='kw'>N_site_bags</span> <span class='kw'>=</span> <span class='fl'>75</span>,
<span class='kw'>sites_var1_mean</span> <span class='kw'>=</span> <span class='fl'>80</span>, <span class='kw'>sites_var1_sd</span>   <span class='kw'>=</span> <span class='fl'>10</span>,
<span class='kw'>sites_var2_mean</span> <span class='kw'>=</span> <span class='fl'>5</span>,  <span class='kw'>sites_var2_sd</span>   <span class='kw'>=</span> <span class='fl'>2</span>,
<span class='kw'>backg_var1_mean</span> <span class='kw'>=</span> <span class='fl'>100</span>,<span class='kw'>backg_var1_sd</span>   <span class='kw'>=</span> <span class='fl'>20</span>,
<span class='kw'>backg_var2_mean</span> <span class='kw'>=</span> <span class='fl'>6</span>,  <span class='kw'>backg_var2_sd</span>   <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>formatted_data</span> <span class='kw'>&lt;-</span> <span class='fu'>format_site_data</span>(<span class='no'>sim_data</span>, <span class='kw'>N_sites</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>train_test_split</span><span class='kw'>=</span><span class='fl'>0.8</span>,
                                   <span class='kw'>sample_fraction</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>background_site_balance</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>train_data</span> <span class='kw'>&lt;-</span> <span class='no'>formatted_data</span><span class='kw'>[[</span><span class='st'>"train_data"</span>]]
<span class='no'>train_presence</span> <span class='kw'>&lt;-</span> <span class='no'>formatted_data</span><span class='kw'>[[</span><span class='st'>"train_presence"</span>]]
<span class='no'>test_presence</span> <span class='kw'>&lt;-</span> <span class='no'>formatted_data</span><span class='kw'>[[</span><span class='st'>"test_presence"</span>]]

<span class='co'>##### Logistic Mean Embedding KLR Model</span>
<span class='co'>#### Build Kernel Matrix</span>
<span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='build_K.html'>build_K</a></span>(<span class='no'>train_data</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>, <span class='kw'>dist_metric</span> <span class='kw'>=</span> <span class='no'>dist_metric</span>)
<span class='co'>#### Train</span>
<span class='no'>train_log_pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='KLR.html'>KLR</a></span>(<span class='no'>K</span>, <span class='no'>train_presence</span>, <span class='no'>lambda</span>, <span class='fl'>100</span>, <span class='fl'>0.001</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='co'>#### Predict</span>
<span class='no'>test_log_pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='KLR_predict.html'>KLR_predict</a></span>(<span class='no'>test_data</span>, <span class='no'>train_data</span>, <span class='kw'>dist_metric</span> <span class='kw'>=</span> <span class='no'>dist_metric</span>,
                            <span class='no'>train_log_pred</span><span class='kw'>[[</span><span class='st'>"alphas"</span>]], <span class='no'>sigma</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Harris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

